<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <script type="text/javascript" src="vendor/jquery/jquery-2.2.3.min.js"></script>
    <script type="text/javascript" src="vendor/viz/viz.js"></script>
    <script type="text/javascript" src="vendor/viz/full.render.js"></script>
</head>
<body>
<script type="text/javascript">
function getQueryVariable(variable)
{
       var query = window.location.search.substring(1);
       var vars = query.split("&");
       for (var i=0;i<vars.length;i++) {
               var pair = vars[i].split("=");
               if(pair[0] == variable){return pair[1];}
       }
       return(false);
}
var httpRequest = new XMLHttpRequest();
var id = getQueryVariable("id");
httpRequest.open('GET', '/v1/graphviz/'+id, true);
httpRequest.send();
httpRequest.onreadystatechange = function () {
    if (httpRequest.readyState == 4 && httpRequest.status == 200) {
        var json = httpRequest.responseText;//获取到json字符串，还需解析
        var obj = JSON.parse(json)
        var viz = new Viz();
        viz.renderSVGElement(obj.data)
            .then(function(element) {
                document.body.appendChild(element);
            })
          .catch(error => {
            // Create a new Viz instance (@see Caveats page for more info)
            viz = new Viz();

            // Possibly display the error
            console.error(error);
          });
    }
};

</script>
</body>
</html>